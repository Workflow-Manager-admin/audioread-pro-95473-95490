{"is_source_file": true, "format": "JavaScript", "description": "This file contains utility functions for extracting, processing, and manipulating text from various document formats such as PDF, DOCX, and TXT. It also includes functions for splitting text into pages and chunks, mapping chunks to pages, and obtaining positional information within the document.", "external_files": ["react-pdf", "mammoth"], "external_methods": ["pdfjs.getDocument", "file.arrayBuffer", "file.text", "mammoth.extractRawText"], "published": ["extractTextFromPDF", "extractTextFromDOCX", "extractTextFromTXT", "processDocument", "countWords", "splitTextIntoChunks", "splitTextIntoPages", "mapChunksToPages", "getPositionInfo", "findChunkByPosition"], "classes": [], "methods": [{"name": "extractTextFromPDF", "description": "Extracts text content from a PDF file, preserving natural page breaks with a special marker."}, {"name": "extractTextFromDOCX", "description": "Extracts raw text from a DOCX file, assuming a single page."}, {"name": "extractTextFromTXT", "description": "Reads plain text from a TXT file."}, {"name": "processDocument", "description": "Determines file type and processes the document accordingly."}, {"name": "countWords", "description": "Counts the number of words in a given text string."}, {"name": "splitTextIntoChunks", "description": "Splits large text into manageable chunks based on sentence boundaries and maximum chunk size."}, {"name": "splitTextIntoPages", "description": "Splits entire document text into pages, respecting PDF page breaks or creating pages based on word count for other formats."}, {"name": "mapChunksToPages", "description": "Creates a mapping from text chunks to pages, tracking character positions for synchronization."}, {"name": "getPositionInfo", "description": "Finds the page and relative position for a specific character offset."}, {"name": "findChunkByPosition", "description": "Locates which chunk contains a specific character position."}, {"name": "calculatePrevPageBreakPos(text, pageIndex)", "scope": "", "scopeKind": "", "description": "unavailable"}], "calls": ["pdfjs.getDocument", "file.arrayBuffer", "file.text", "mammoth.extractRawText"], "search-terms": ["extractTextFromPDF", "splitTextIntoPages", "mapChunksToPages", "PDF.js", "DOCX", "text splitting", "page mapping", "character position"], "state": 2, "file_id": 19, "knowledge_revision": 145, "git_revision": "09f04c09d8d77e2fdd2da45aed60a37c72dc1fe2", "revision_history": [{"39": "191b71a9f2e33d34d4f389f0469c7f0e0b9ca988"}, {"50": "4ab51283e17f76ebe385e277d007918fccf96dd5"}, {"121": "c9e4d072d50e1e874483c995dbae7ac49ddf87a6"}, {"144": "3a18d517fcab46acffdd5f6fdf12ec38785feaa9"}, {"145": "09f04c09d8d77e2fdd2da45aed60a37c72dc1fe2"}], "ctags": [{"_type": "tag", "name": "accumulatedLength", "path": "/home/kavia/workspace/code-generation/audioread-pro-95473-95490/audio_read_pro/src/utils/documentUtils.js", "pattern": "/^  let accumulatedLength = 0;$/", "language": "JavaScript", "kind": "variable"}, {"_type": "tag", "name": "arrayBuffer", "path": "/home/kavia/workspace/code-generation/audioread-pro-95473-95490/audio_read_pro/src/utils/documentUtils.js", "pattern": "/^    const arrayBuffer = await file.arrayBuffer();$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "calculatePrevPageBreakPos", "path": "/home/kavia/workspace/code-generation/audioread-pro-95473-95490/audio_read_pro/src/utils/documentUtils.js", "pattern": "/^function calculatePrevPageBreakPos(text, pageIndex) {$/", "language": "JavaScript", "kind": "function", "signature": "(text, pageIndex)"}, {"_type": "tag", "name": "chunkEnd", "path": "/home/kavia/workspace/code-generation/audioread-pro-95473-95490/audio_read_pro/src/utils/documentUtils.js", "pattern": "/^    const chunkEnd = accumulatedLength + chunks[i].length;$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "chunkPositions", "path": "/home/kavia/workspace/code-generation/audioread-pro-95473-95490/audio_read_pro/src/utils/documentUtils.js", "pattern": "/^    chunkPositions: {}, \\/\\/ Store character positions for each chunk$/", "language": "JavaScript", "kind": "property", "scope": "mapping", "scopeKind": "class"}, {"_type": "tag", "name": "chunkToPage", "path": "/home/kavia/workspace/code-generation/audioread-pro-95473-95490/audio_read_pro/src/utils/documentUtils.js", "pattern": "/^    chunkToPage: {}, \\/\\/ Map chunk index to page number$/", "language": "JavaScript", "kind": "property", "scope": "mapping", "scopeKind": "class"}, {"_type": "tag", "name": "chunks", "path": "/home/kavia/workspace/code-generation/audioread-pro-95473-95490/audio_read_pro/src/utils/documentUtils.js", "pattern": "/^  const chunks = [];$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "cleanParagraph", "path": "/home/kavia/workspace/code-generation/audioread-pro-95473-95490/audio_read_pro/src/utils/documentUtils.js", "pattern": "/^    const cleanParagraph = paragraph.trim();$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "countWords", "path": "/home/kavia/workspace/code-generation/audioread-pro-95473-95490/audio_read_pro/src/utils/documentUtils.js", "pattern": "/^export const countWords = (text) => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "currentChunk", "path": "/home/kavia/workspace/code-generation/audioread-pro-95473-95490/audio_read_pro/src/utils/documentUtils.js", "pattern": "/^  let currentChunk = '';$/", "language": "JavaScript", "kind": "variable"}, {"_type": "tag", "name": "currentPage", "path": "/home/kavia/workspace/code-generation/audioread-pro-95473-95490/audio_read_pro/src/utils/documentUtils.js", "pattern": "/^  let currentPage = '';$/", "language": "JavaScript", "kind": "variable"}, {"_type": "tag", "name": "currentWordCount", "path": "/home/kavia/workspace/code-generation/audioread-pro-95473-95490/audio_read_pro/src/utils/documentUtils.js", "pattern": "/^  let currentWordCount = 0;$/", "language": "JavaScript", "kind": "variable"}, {"_type": "tag", "name": "extractTextFromDOCX", "path": "/home/kavia/workspace/code-generation/audioread-pro-95473-95490/audio_read_pro/src/utils/documentUtils.js", "pattern": "/^export const extractTextFromDOCX = async (file) => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "extractTextFromPDF", "path": "/home/kavia/workspace/code-generation/audioread-pro-95473-95490/audio_read_pro/src/utils/documentUtils.js", "pattern": "/^export const extractTextFromPDF = async (file) => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "extractTextFromTXT", "path": "/home/kavia/workspace/code-generation/audioread-pro-95473-95490/audio_read_pro/src/utils/documentUtils.js", "pattern": "/^export const extractTextFromTXT = async (file) => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "fileType", "path": "/home/kavia/workspace/code-generation/audioread-pro-95473-95490/audio_read_pro/src/utils/documentUtils.js", "pattern": "/^  const fileType = file.name.split('.').pop().toLowerCase();$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "findChunkByPosition", "path": "/home/kavia/workspace/code-generation/audioread-pro-95473-95490/audio_read_pro/src/utils/documentUtils.js", "pattern": "/^export const findChunkByPosition = (charPosition, chunks) => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "fullText", "path": "/home/kavia/workspace/code-generation/audioread-pro-95473-95490/audio_read_pro/src/utils/documentUtils.js", "pattern": "/^    let fullText = '';$/", "language": "JavaScript", "kind": "variable"}, {"_type": "tag", "name": "getPositionInfo", "path": "/home/kavia/workspace/code-generation/audioread-pro-95473-95490/audio_read_pro/src/utils/documentUtils.js", "pattern": "/^export const getPositionInfo = (charOffset, mapping, pages) => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "mapChunksToPages", "path": "/home/kavia/workspace/code-generation/audioread-pro-95473-95490/audio_read_pro/src/utils/documentUtils.js", "pattern": "/^export const mapChunksToPages = (chunks, pages) => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "mapping", "path": "/home/kavia/workspace/code-generation/audioread-pro-95473-95490/audio_read_pro/src/utils/documentUtils.js", "pattern": "/^  const mapping = {$/", "language": "JavaScript", "kind": "class"}, {"_type": "tag", "name": "page", "path": "/home/kavia/workspace/code-generation/audioread-pro-95473-95490/audio_read_pro/src/utils/documentUtils.js", "pattern": "/^      const page = await pdf.getPage(i);$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "pageNumber", "path": "/home/kavia/workspace/code-generation/audioread-pro-95473-95490/audio_read_pro/src/utils/documentUtils.js", "pattern": "/^  const pageNumber = pages.findIndex(page => $/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "pageNumber", "path": "/home/kavia/workspace/code-generation/audioread-pro-95473-95490/audio_read_pro/src/utils/documentUtils.js", "pattern": "/^  let pageNumber = 1;$/", "language": "JavaScript", "kind": "variable"}, {"_type": "tag", "name": "pagePositions", "path": "/home/kavia/workspace/code-generation/audioread-pro-95473-95490/audio_read_pro/src/utils/documentUtils.js", "pattern": "/^    pagePositions: {} \\/\\/ Store character positions for each page$/", "language": "JavaScript", "kind": "property", "scope": "mapping", "scopeKind": "class"}, {"_type": "tag", "name": "pageStartPos", "path": "/home/kavia/workspace/code-generation/audioread-pro-95473-95490/audio_read_pro/src/utils/documentUtils.js", "pattern": "/^  const pageStartPos = pages[pageNumber - 1].startPosition;$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "pageText", "path": "/home/kavia/workspace/code-generation/audioread-pro-95473-95490/audio_read_pro/src/utils/documentUtils.js", "pattern": "/^      const pageText = currentPage.trim();$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "pageText", "path": "/home/kavia/workspace/code-generation/audioread-pro-95473-95490/audio_read_pro/src/utils/documentUtils.js", "pattern": "/^      const pageText = textContent.items.map(item => item.str).join(' ');$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "pageText", "path": "/home/kavia/workspace/code-generation/audioread-pro-95473-95490/audio_read_pro/src/utils/documentUtils.js", "pattern": "/^    const pageText = currentPage.trim();$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "pageToChunks", "path": "/home/kavia/workspace/code-generation/audioread-pro-95473-95490/audio_read_pro/src/utils/documentUtils.js", "pattern": "/^    pageToChunks: {}, \\/\\/ Map page number to array of chunk indices$/", "language": "JavaScript", "kind": "property", "scope": "mapping", "scopeKind": "class"}, {"_type": "tag", "name": "pages", "path": "/home/kavia/workspace/code-generation/audioread-pro-95473-95490/audio_read_pro/src/utils/documentUtils.js", "pattern": "/^  const pages = [];$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "paragraphWordCount", "path": "/home/kavia/workspace/code-generation/audioread-pro-95473-95490/audio_read_pro/src/utils/documentUtils.js", "pattern": "/^    const paragraphWordCount = countWords(cleanParagraph);$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "paragraphs", "path": "/home/kavia/workspace/code-generation/audioread-pro-95473-95490/audio_read_pro/src/utils/documentUtils.js", "pattern": "/^  const paragraphs = text.split(\\/\\\\n\\\\s*\\\\n\\/);$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "pdf", "path": "/home/kavia/workspace/code-generation/audioread-pro-95473-95490/audio_read_pro/src/utils/documentUtils.js", "pattern": "/^    const pdf = await pdfjs.getDocument(arrayBuffer).promise;$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "pdfPageBreaks", "path": "/home/kavia/workspace/code-generation/audioread-pro-95473-95490/audio_read_pro/src/utils/documentUtils.js", "pattern": "/^  const pdfPageBreaks = text.includes('<!-- PAGE_BREAK -->');$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "pdfPages", "path": "/home/kavia/workspace/code-generation/audioread-pro-95473-95490/audio_read_pro/src/utils/documentUtils.js", "pattern": "/^    const pdfPages = text.split('<!-- PAGE_BREAK -->');$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "processDocument", "path": "/home/kavia/workspace/code-generation/audioread-pro-95473-95490/audio_read_pro/src/utils/documentUtils.js", "pattern": "/^export const processDocument = async (file) => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "relativeOffset", "path": "/home/kavia/workspace/code-generation/audioread-pro-95473-95490/audio_read_pro/src/utils/documentUtils.js", "pattern": "/^  const relativeOffset = charOffset - pageStartPos;$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "result", "path": "/home/kavia/workspace/code-generation/audioread-pro-95473-95490/audio_read_pro/src/utils/documentUtils.js", "pattern": "/^    const result = await mammoth.extractRawText({ arrayBuffer });$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "sentences", "path": "/home/kavia/workspace/code-generation/audioread-pro-95473-95490/audio_read_pro/src/utils/documentUtils.js", "pattern": "/^  const sentences = text.match(\\/[^.!?]+[.!?]+\\/g) || [];$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "splitTextIntoChunks", "path": "/home/kavia/workspace/code-generation/audioread-pro-95473-95490/audio_read_pro/src/utils/documentUtils.js", "pattern": "/^export const splitTextIntoChunks = (text, maxChunkSize = 5000) => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "splitTextIntoPages", "path": "/home/kavia/workspace/code-generation/audioread-pro-95473-95490/audio_read_pro/src/utils/documentUtils.js", "pattern": "/^export const splitTextIntoPages = (text, pageCount = 1, wordsPerPage = 300) => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "startPosition", "path": "/home/kavia/workspace/code-generation/audioread-pro-95473-95490/audio_read_pro/src/utils/documentUtils.js", "pattern": "/^  let startPosition = 0;$/", "language": "JavaScript", "kind": "variable"}, {"_type": "tag", "name": "text", "path": "/home/kavia/workspace/code-generation/audioread-pro-95473-95490/audio_read_pro/src/utils/documentUtils.js", "pattern": "/^    const text = await file.text();$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "textContent", "path": "/home/kavia/workspace/code-generation/audioread-pro-95473-95490/audio_read_pro/src/utils/documentUtils.js", "pattern": "/^      const textContent = await page.getTextContent();$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "totalCharCount", "path": "/home/kavia/workspace/code-generation/audioread-pro-95473-95490/audio_read_pro/src/utils/documentUtils.js", "pattern": "/^  let totalCharCount = 0;$/", "language": "JavaScript", "kind": "variable"}, {"_type": "tag", "name": "totalWordCount", "path": "/home/kavia/workspace/code-generation/audioread-pro-95473-95490/audio_read_pro/src/utils/documentUtils.js", "pattern": "/^  const totalWordCount = countWords(text);$/", "language": "JavaScript", "kind": "constant"}], "filename": "/home/kavia/workspace/code-generation/audioread-pro-95473-95490/audio_read_pro/src/utils/documentUtils.js", "hash": "7d23deac76a813685394c7452374a217", "format-version": 4, "code-base-name": "default", "fields": [{"name": "let accumulatedLength = 0;", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "chunkPositions: {}, \\/\\/ Store character positions for each chunk", "scope": "mapping", "scopeKind": "class", "description": "unavailable"}, {"name": "chunkToPage: {}, \\/\\/ Map chunk index to page number", "scope": "mapping", "scopeKind": "class", "description": "unavailable"}, {"name": "let currentChunk = '';", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "let currentPage = '';", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "let currentWordCount = 0;", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "let fullText = '';", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "let pageNumber = 1;", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "pagePositions: {} \\/\\/ Store character positions for each page", "scope": "mapping", "scopeKind": "class", "description": "unavailable"}, {"name": "pageToChunks: {}, \\/\\/ Map page number to array of chunk indices", "scope": "mapping", "scopeKind": "class", "description": "unavailable"}, {"name": "let startPosition = 0;", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "let totalCharCount = 0;", "scope": "", "scopeKind": "", "description": "unavailable"}]}