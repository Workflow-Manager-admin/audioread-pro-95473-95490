{"is_source_file": true, "format": "JavaScript (ES6)", "description": "This file provides utility functions for processing documents of various formats (PDF, DOCX, TXT), including extracting text, splitting text into chunks and pages, and mapping chunks to pages. It supports PDF.js for PDF processing and Mammoth for DOCX extraction, and implements methods to facilitate document navigation and speech synthesis.", "external_files": ["react-pdf", "mammoth"], "external_methods": ["pdfjs.getDocument", "file.arrayBuffer", "mammoth.extractRawText", "file.text"], "published": ["extractTextFromPDF", "extractTextFromDOCX", "extractTextFromTXT", "processDocument", "splitTextIntoChunks", "splitTextIntoPages", "mapChunksToPages"], "classes": [], "methods": [{"name": "extractTextFromPDF", "description": "Extracts text content from a PDF file using react-pdf's PDF.js API. Processes each page and concatenates text for full document extraction."}, {"name": "extractTextFromDOCX", "description": "Uses Mammoth to extract raw text from a DOCX file buffer."}, {"name": "extractTextFromTXT", "description": "Reads plain text from a TXT file."}, {"name": "processDocument", "description": "Determines file type by extension and dispatches to appropriate extraction function."}, {"name": "splitTextIntoChunks", "description": "Splits large document text into manageable chunks based on sentence boundaries and maximum chunk size."}, {"name": "splitTextIntoPages", "description": "Splits document text into pages, trying to honor actual page breaks in PDFs or approximating based on word count if not available."}, {"name": "mapChunksToPages", "description": "Estimates and maps chunks of text to corresponding pages, facilitating navigation and synchronization in multi-page documents."}], "calls": ["pdfjs.getDocument", "file.arrayBuffer", "page.getTextContent", "mammoth.extractRawText", "file.text"], "search-terms": ["extractTextFromPDF", "PDF.js", "mammoth", "splitTextIntoChunks", "splitTextIntoPages", "mapChunksToPages", "documentUtils"], "state": 2, "file_id": 19, "knowledge_revision": 144, "git_revision": "3a18d517fcab46acffdd5f6fdf12ec38785feaa9", "revision_history": [{"39": "191b71a9f2e33d34d4f389f0469c7f0e0b9ca988"}, {"50": "4ab51283e17f76ebe385e277d007918fccf96dd5"}, {"121": "c9e4d072d50e1e874483c995dbae7ac49ddf87a6"}, {"144": "3a18d517fcab46acffdd5f6fdf12ec38785feaa9"}], "ctags": [{"_type": "tag", "name": "arrayBuffer", "path": "/home/kavia/workspace/code-generation/audioread-pro-95473-95490/audio_read_pro/src/utils/documentUtils.js", "pattern": "/^    const arrayBuffer = await file.arrayBuffer();$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "breakIndex", "path": "/home/kavia/workspace/code-generation/audioread-pro-95473-95490/audio_read_pro/src/utils/documentUtils.js", "pattern": "/^          const breakIndex = potentialBreaks[targetIndex].index;$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "chunkToPage", "path": "/home/kavia/workspace/code-generation/audioread-pro-95473-95490/audio_read_pro/src/utils/documentUtils.js", "pattern": "/^    chunkToPage: {}, \\/\\/ Map chunk index to page number$/", "language": "JavaScript", "kind": "property", "scope": "mapping", "scopeKind": "class"}, {"_type": "tag", "name": "chunks", "path": "/home/kavia/workspace/code-generation/audioread-pro-95473-95490/audio_read_pro/src/utils/documentUtils.js", "pattern": "/^  const chunks = [];$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "currentChunk", "path": "/home/kavia/workspace/code-generation/audioread-pro-95473-95490/audio_read_pro/src/utils/documentUtils.js", "pattern": "/^  let currentChunk = '';$/", "language": "JavaScript", "kind": "variable"}, {"_type": "tag", "name": "currentPage", "path": "/home/kavia/workspace/code-generation/audioread-pro-95473-95490/audio_read_pro/src/utils/documentUtils.js", "pattern": "/^  let currentPage = '';$/", "language": "JavaScript", "kind": "variable"}, {"_type": "tag", "name": "currentWordCount", "path": "/home/kavia/workspace/code-generation/audioread-pro-95473-95490/audio_read_pro/src/utils/documentUtils.js", "pattern": "/^  let currentWordCount = 0;$/", "language": "JavaScript", "kind": "variable"}, {"_type": "tag", "name": "extractTextFromDOCX", "path": "/home/kavia/workspace/code-generation/audioread-pro-95473-95490/audio_read_pro/src/utils/documentUtils.js", "pattern": "/^export const extractTextFromDOCX = async (file) => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "extractTextFromPDF", "path": "/home/kavia/workspace/code-generation/audioread-pro-95473-95490/audio_read_pro/src/utils/documentUtils.js", "pattern": "/^export const extractTextFromPDF = async (file) => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "extractTextFromTXT", "path": "/home/kavia/workspace/code-generation/audioread-pro-95473-95490/audio_read_pro/src/utils/documentUtils.js", "pattern": "/^export const extractTextFromTXT = async (file) => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "fileType", "path": "/home/kavia/workspace/code-generation/audioread-pro-95473-95490/audio_read_pro/src/utils/documentUtils.js", "pattern": "/^  const fileType = file.name.split('.').pop().toLowerCase();$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "fullText", "path": "/home/kavia/workspace/code-generation/audioread-pro-95473-95490/audio_read_pro/src/utils/documentUtils.js", "pattern": "/^    let fullText = '';$/", "language": "JavaScript", "kind": "variable"}, {"_type": "tag", "name": "lastIndex", "path": "/home/kavia/workspace/code-generation/audioread-pro-95473-95490/audio_read_pro/src/utils/documentUtils.js", "pattern": "/^      let lastIndex = 0;$/", "language": "JavaScript", "kind": "variable"}, {"_type": "tag", "name": "mapChunksToPages", "path": "/home/kavia/workspace/code-generation/audioread-pro-95473-95490/audio_read_pro/src/utils/documentUtils.js", "pattern": "/^export const mapChunksToPages = (chunks, pages) => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "mapping", "path": "/home/kavia/workspace/code-generation/audioread-pro-95473-95490/audio_read_pro/src/utils/documentUtils.js", "pattern": "/^  const mapping = {$/", "language": "JavaScript", "kind": "class"}, {"_type": "tag", "name": "page", "path": "/home/kavia/workspace/code-generation/audioread-pro-95473-95490/audio_read_pro/src/utils/documentUtils.js", "pattern": "/^      const page = await pdf.getPage(i);$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "pageBreakPattern", "path": "/home/kavia/workspace/code-generation/audioread-pro-95473-95490/audio_read_pro/src/utils/documentUtils.js", "pattern": "/^    const pageBreakPattern = \\/\\\\n\\\\s*\\\\n|\\\\f\\/g;$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "pageNumber", "path": "/home/kavia/workspace/code-generation/audioread-pro-95473-95490/audio_read_pro/src/utils/documentUtils.js", "pattern": "/^  let pageNumber = 1;$/", "language": "JavaScript", "kind": "variable"}, {"_type": "tag", "name": "pageText", "path": "/home/kavia/workspace/code-generation/audioread-pro-95473-95490/audio_read_pro/src/utils/documentUtils.js", "pattern": "/^      const pageText = textContent.items.map(item => item.str).join(' ');$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "pageToChunks", "path": "/home/kavia/workspace/code-generation/audioread-pro-95473-95490/audio_read_pro/src/utils/documentUtils.js", "pattern": "/^    pageToChunks: {} \\/\\/ Map page number to array of chunk indices$/", "language": "JavaScript", "kind": "property", "scope": "mapping", "scopeKind": "class"}, {"_type": "tag", "name": "pages", "path": "/home/kavia/workspace/code-generation/audioread-pro-95473-95490/audio_read_pro/src/utils/documentUtils.js", "pattern": "/^      const pages = [];$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "pages", "path": "/home/kavia/workspace/code-generation/audioread-pro-95473-95490/audio_read_pro/src/utils/documentUtils.js", "pattern": "/^  const pages = [];$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "paragraphWordCount", "path": "/home/kavia/workspace/code-generation/audioread-pro-95473-95490/audio_read_pro/src/utils/documentUtils.js", "pattern": "/^    const paragraphWordCount = (paragraph.match(\\/\\\\S+\\/g) || []).length;$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "paragraphs", "path": "/home/kavia/workspace/code-generation/audioread-pro-95473-95490/audio_read_pro/src/utils/documentUtils.js", "pattern": "/^  const paragraphs = text.split(\\/\\\\n\\\\s*\\\\n\\/);$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "pdf", "path": "/home/kavia/workspace/code-generation/audioread-pro-95473-95490/audio_read_pro/src/utils/documentUtils.js", "pattern": "/^    const pdf = await pdfjs.getDocument(arrayBuffer).promise;$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "potentialBreaks", "path": "/home/kavia/workspace/code-generation/audioread-pro-95473-95490/audio_read_pro/src/utils/documentUtils.js", "pattern": "/^    const potentialBreaks = [...text.matchAll(pageBreakPattern)];$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "processDocument", "path": "/home/kavia/workspace/code-generation/audioread-pro-95473-95490/audio_read_pro/src/utils/documentUtils.js", "pattern": "/^export const processDocument = async (file) => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "result", "path": "/home/kavia/workspace/code-generation/audioread-pro-95473-95490/audio_read_pro/src/utils/documentUtils.js", "pattern": "/^    const result = await mammoth.extractRawText({ arrayBuffer });$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "sentences", "path": "/home/kavia/workspace/code-generation/audioread-pro-95473-95490/audio_read_pro/src/utils/documentUtils.js", "pattern": "/^  const sentences = text.match(\\/[^.!?]+[.!?]+\\/g) || [];$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "splitTextIntoChunks", "path": "/home/kavia/workspace/code-generation/audioread-pro-95473-95490/audio_read_pro/src/utils/documentUtils.js", "pattern": "/^export const splitTextIntoChunks = (text, maxChunkSize = 5000) => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "splitTextIntoPages", "path": "/home/kavia/workspace/code-generation/audioread-pro-95473-95490/audio_read_pro/src/utils/documentUtils.js", "pattern": "/^export const splitTextIntoPages = (text, pageCount = 1, avgWordsPerPage = 500) => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "targetIndex", "path": "/home/kavia/workspace/code-generation/audioread-pro-95473-95490/audio_read_pro/src/utils/documentUtils.js", "pattern": "/^        const targetIndex = Math.round((i + 1) * potentialBreaks.length \\/ pageCount) - 1;$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "text", "path": "/home/kavia/workspace/code-generation/audioread-pro-95473-95490/audio_read_pro/src/utils/documentUtils.js", "pattern": "/^    const text = await file.text();$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "textContent", "path": "/home/kavia/workspace/code-generation/audioread-pro-95473-95490/audio_read_pro/src/utils/documentUtils.js", "pattern": "/^      const textContent = await page.getTextContent();$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "words", "path": "/home/kavia/workspace/code-generation/audioread-pro-95473-95490/audio_read_pro/src/utils/documentUtils.js", "pattern": "/^  const words = text.match(\\/\\\\S+\\/g) || [];$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "wordsPerPage", "path": "/home/kavia/workspace/code-generation/audioread-pro-95473-95490/audio_read_pro/src/utils/documentUtils.js", "pattern": "/^  const wordsPerPage = Math.ceil(words.length \\/ pageCount);$/", "language": "JavaScript", "kind": "constant"}], "filename": "/home/kavia/workspace/code-generation/audioread-pro-95473-95490/audio_read_pro/src/utils/documentUtils.js", "hash": "06d2c010645155e37c63c71be46fbdae", "format-version": 4, "code-base-name": "default", "fields": [{"name": "chunkToPage: {}, \\/\\/ Map chunk index to page number", "scope": "mapping", "scopeKind": "class", "description": "unavailable"}, {"name": "let currentChunk = '';", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "let currentPage = '';", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "let currentWordCount = 0;", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "let fullText = '';", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "let lastIndex = 0;", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "let pageNumber = 1;", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "pageToChunks: {} \\/\\/ Map page number to array of chunk indices", "scope": "mapping", "scopeKind": "class", "description": "unavailable"}]}